<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ğŸŒ¿ Dream OS v4.3.3 | SIF Al Fikri</title>
  <meta name="theme-color" content="#EAF7ED">
  <meta name="description" content="System Administrasi SIF Al Fikri - Booking 19 Sarana, K3, Inventaris + Cloud Sync">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="data:application/json,{'name':'Dream OS','short_name':'DreamOS','theme_color':'#EAF7ED','background_color':'#F8FCF6','display':'standalone','icons':[{'src':'https://cdn.jsdelivr.net/npm/twemoji@14.0.2/assets/svg/1f33f.svg','sizes':'192x192','type':'image/svg+xml'}]}">

  <style>
    /* ========== HEALING GREEN PREMIUM PALETTE ========== */
    :root {
      --bg-main: #F8FCF6;
      --bg-card: #EAF7ED;
      --accent: #4CAF50;
      --accent-hover: #45A049;
      --text-dark: #2E7D32;
      --border-soft: #C8E6C9;
      --shadow-soft: rgba(0,0,0,0.05);
      --shadow-hover: rgba(0,0,0,0.08);
    }

    /* ========== RESET & BASE ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html {
      scroll-behavior: smooth;
      background: var(--bg-main);
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: var(--bg-main);
      color: var(--text-dark);
      line-height: 1.6;
      padding: 16px;
      max-width: 520px;
      margin: 0 auto;
      min-height: 100vh;
      animation: fadeIn 0.6s ease-out;
    }

    /* ========== HEADER PREMIUM ========== */
    .header-gradient {
      background: linear-gradient(135deg, #EAF7ED 0%, #F8FCF6 100%);
      padding: 24px 20px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 20px;
      border: 1px solid var(--border-soft);
      box-shadow: 0 4px 12px var(--shadow-soft);
    }

    .arabic-large {
      font-size: 1.8rem;
      color: var(--text-dark);
      direction: rtl;
      margin: 8px 0;
      font-weight: bold;
      opacity: 0.9;
    }

    .title-main {
      font-size: 1.8rem;
      color: var(--text-dark);
      margin: 12px 0 6px;
      font-weight: 700;
    }

    .subtitle {
      color: #666;
      font-size: 0.95rem;
      margin-bottom: 15px;
    }

    /* ========== STATUS BADGES MEWAH ========== */
    .badge-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 15px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      border-radius: 24px;
      font-size: 0.85rem;
      font-weight: 600;
      background: white;
      border: 1px solid var(--border-soft);
      box-shadow: 0 2px 6px var(--shadow-soft);
    }

    .badge.online { color: #4CAF50; }
    .badge.cloud { color: #2196F3; }
    .badge.ready { color: #FF9800; }

    /* ========== CARD SYSTEM PREMIUM ========== */
    .container {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .card {
      background: var(--bg-card);
      border-radius: 18px;
      padding: 20px;
      box-shadow: 0 4px 12px var(--shadow-soft);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid var(--border-soft);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px var(--shadow-hover);
    }

    .card:active {
      transform: translateY(-1px);
    }

    .card-icon {
      font-size: 1.8rem;
      margin-bottom: 12px;
      display: inline-block;
    }

    .card-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
    }

    .card-desc {
      color: #666;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    /* ========== BUTTONS PREMIUM ========== */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 24px;
      border-radius: 14px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      text-decoration: none;
      width: 100%;
      margin-top: 10px;
    }

    .btn-primary {
      background: var(--accent);
      color: white;
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.25);
    }

    .btn-primary:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(76, 175, 80, 0.35);
    }

    .btn-secondary {
      background: white;
      color: var(--text-dark);
      border: 1px solid var(--border-soft);
    }

    .btn-secondary:hover {
      background: var(--bg-card);
      transform: translateY(-2px);
    }

    /* ========== FORM ELEMENTS ========== */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      color: var(--text-dark);
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 14px 16px;
      border: 1.5px solid var(--border-soft);
      border-radius: 12px;
      font-size: 1rem;
      background: white;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    optgroup {
      font-weight: 600;
      color: var(--text-dark);
    }

    option {
      padding: 8px;
    }

    /* ========== CALENDAR MINIMALIS ========== */
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      margin-top: 15px;
    }

    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      background: white;
      border: 1px solid var(--border-soft);
    }

    .calendar-day:hover {
      background: var(--bg-card);
      transform: scale(1.05);
    }

    .calendar-day.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* ========== FOOTER ELEGANT ========== */
    .footer {
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid var(--border-soft);
      text-align: center;
      color: #666;
      font-size: 0.9rem;
    }

    .contact-box {
      background: white;
      border-radius: 14px;
      padding: 18px;
      margin: 20px 0;
      border: 1px solid var(--border-soft);
    }

    /* ========== ANIMATIONS ========== */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in {
      animation: fadeIn 0.6s ease-out;
    }

    /* ========== LOADING SCREEN ========== */
    #loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-main);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }

    .loading-content {
      text-align: center;
    }

    .loading-emoji {
      font-size: 3rem;
      margin-bottom: 20px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 480px) {
      body { padding: 12px; }
      .header-gradient { padding: 20px 16px; }
      .card { padding: 16px; }
      .btn { padding: 12px 20px; }
    }

    /* ========== UTILITY CLASSES ========== */
    .text-center { text-align: center; }
    .mb-2 { margin-bottom: 16px; }
    .mt-2 { margin-top: 16px; }
    .hidden { display: none !important; }
    .form-slot { display: none; }
  </style>
</head>
<body>
  <!-- LOADING SCREEN -->
  <div id="loading">
    <div class="loading-content">
      <div class="loading-emoji">ğŸŒ¿</div>
      <div style="color: var(--text-dark); font-size: 1.1rem; font-weight: 600;">
        Loading Dream OS...
      </div>
      <div style="color: #666; font-size: 0.9rem; margin-top: 8px;">
        Healing Green Premium Theme â€¢ 19 Sarana
      </div>
    </div>
  </div>

  <!-- MAIN APP -->
  <div class="container fade-in" id="app" style="display: none;">
    <!-- HEADER -->
    <div class="header-gradient">
      <div class="arabic-large">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
      <div class="arabic-large">Ø§ÙÙ„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ø³ÙÙŠÙÙ‘Ø¯ÙÙ†ÙØ§ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù</div>
      
      <h1 class="title-main">ğŸŒ¿ Dream OS v4.3.3</h1>
      <div class="subtitle">SIF Al Fikri â€¢ 19 Sarana â€¢ General Affairs System</div>
      
      <div class="badge-container">
        <div class="badge online">ğŸŸ¢ ONLINE</div>
        <div class="badge cloud">â˜ï¸ CLOUD SYNC</div>
        <div class="badge ready">âœ… System Ready</div>
      </div>
    </div>

    <!-- CALENDAR -->
    <div class="card" onclick="showCalendarDetails()">
      <div class="card-icon">ğŸ“…</div>
      <h3 class="card-title">Jadwal 7 Hari</h3>
      <div class="calendar-grid">
        <div class="calendar-day active">
          <div style="font-size: 0.8rem;">KAM</div>
          <div style="font-size: 1.1rem;">25</div>
        </div>
        <div class="calendar-day">
          <div style="font-size: 0.8rem;">JUM</div>
          <div style="font-size: 1.1rem;">26</div>
        </div>
        <div class="calendar-day">
          <div style="font-size: 0.8rem;">SAB</div>
          <div style="font-size: 1.1rem;">27</div>
        </div>
        <div class="calendar-day">
          <div style="font-size: 0.8rem;">MIN</div>
          <div style="font-size: 1.1rem;">28</div>
        </div>
        <div class="calendar-day">
          <div style="font-size: 0.8rem;">SEN</div>
          <div style="font-size: 1.1rem;">29</div>
        </div>
        <div class="calendar-day">
          <div style="font-size: 0.8rem;">SEL</div>
          <div style="font-size: 1.1rem;">30</div>
        </div>
        <div class="calendar-day">
          <div style="font-size: 0.8rem;">RAB</div>
          <div style="font-size: 1.1rem;">31</div>
        </div>
      </div>
      <div class="text-center mt-2" style="color: #666; font-size: 0.85rem;">
        Tap untuk detail booking
      </div>
    </div>

    <!-- MAIN MENU -->
    <div class="card" onclick="switchView('booking')">
      <div class="card-icon">ğŸ“</div>
      <h3 class="card-title">Form Booking</h3>
      <p class="card-desc">Booking 19 sarana lengkap dengan validasi otomatis hari & jam</p>
    </div>

    <div class="card" onclick="switchView('k3')">
      <div class="card-icon">âš ï¸</div>
      <h3 class="card-title">Form K3</h3>
      <p class="card-desc">Laporan kerusakan + kamera dokumentasi langsung ke Pak Erwin</p>
    </div>

    <div class="card" onclick="switchView('admin')">
      <div class="card-icon">ğŸ”</div>
      <h3 class="card-title">Admin Panel</h3>
      <p class="card-desc">Login dengan email: <strong>teknisi@alfikri.sch.id</strong></p>
    </div>

    <div class="card" onclick="switchView('sync')">
      <div class="card-icon">â˜ï¸</div>
      <h3 class="card-title">Cloud Status</h3>
      <p class="card-desc">Monitoring sinkronisasi data & queue system</p>
    </div>

    <!-- PARTIAL SLOTS -->
    <div id="slot-booking" class="form-slot"></div>
    <div id="slot-k3" class="form-slot"></div>
    <div id="slot-admin" class="form-slot"></div>
    <div id="slot-sync" class="form-slot"></div>

    <!-- CONTACT BOX -->
    <div class="contact-box">
      <h3 style="color: var(--text-dark); margin-bottom: 12px; font-size: 1.1rem;">ğŸ“ Kontak Resmi</h3>
      <div style="line-height: 1.8;">
        <div><strong>Pak Erwin</strong> â€“ Koordinator GA</div>
        <div style="color: var(--accent); font-weight: 600;">+62 888-6183-954</div>
        <div style="margin-top: 8px;"><strong>Email Dukungan Teknis:</strong></div>
        <div style="color: var(--accent);">teknisi@alfikri.sch.id</div>
      </div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
      <div style="color: var(--text-dark); font-weight: 600; margin-bottom: 8px;">
        Dream Team â€¢ The Power Soul of Shalawat
      </div>
      <div style="font-size: 0.85rem;">
        Â© 2025 SIF Al Fikri â€¢ 19 Sarana â€¢ Healing Green Premium<br>
        ğŸ‡²ğŸ‡¨ğŸ‡µğŸ‡¸ Built with â¤ï¸ & ğŸ•Œ
      </div>
    </div>
  </div>

  <!-- PARTIAL TEMPLATES -->
  <template id="partial-booking">
    <div class="header-gradient">
      <div class="arabic-large">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
      <h1 class="title-main">ğŸ“… Form Booking</h1>
      <div class="subtitle">Pilih dari 19 sarana dengan validasi hari & jam otomatis</div>
    </div>

    <div class="card">
      <form id="bookingForm" onsubmit="event.preventDefault(); submitBooking();">
        <div class="form-group">
          <label class="form-label">Nama Lengkap *</label>
          <input type="text" class="form-input" id="bookingNama" placeholder="Masukkan nama lengkap" required>
        </div>

        <div class="form-group">
          <label class="form-label">Divisi *</label>
          <select class="form-select" id="bookingDivisi" required>
            <option value="">-- Pilih Divisi --</option>
            <option value="SD">SD</option>
            <option value="SMP">SMP</option>
            <option value="SMA">SMA</option>
            <option value="UMUM">UMUM</option>     
        </select>
        </div>

        <div class="form-group">
          <label class="form-label">Nomor WhatsApp *</label>
          <input type="tel" class="form-input" id="bookingWA" placeholder="08123456789" required>
        </div>

        <div class="form-group">
          <label class="form-label">Sarana yang Dipesan *</label>
          <select class="form-select" id="bookingSarana" required>
            <option value="">-- Pilih Sarana --</option>
            <optgroup label="ğŸ¢ Aula & Serbaguna">
              <option value="Aula SMP - sound, lighting, ac, projector (include)">1. Aula SMP - sound, lighting, ac, projector (include)</option>
              <option value="Aula SMA - sound, projector (include)">2. Aula SMA - sound, projector (include)</option>
              <option value="Saung Besar - sound (include)">3. Saung Besar - sound (include)</option>
              <option value="Saung Kecil">4. Saung Kecil</option>
              <option value="Serbaguna - sound (include)">5. Serbaguna - sound (include)</option>
            </optgroup>
            <optgroup label="ğŸ’» Lab Komputer">
              <option value="Labkom SD">6. Labkom SD</option>
              <option value="Labkom SMP">7. Labkom SMP</option>
              <option value="Labkom SMA">8. Labkom SMA</option>
            </optgroup>
            <optgroup label="âš½ Lapangan Olahraga">
              <option value="Lapangan Basket">9. Lapangan Basket</option>
              <option value="Lapangan Futsal">10. Lapangan Futsal</option>
              <option value="Lapangan Voli">11. Lapangan Voli</option>
              <option value="Lapangan SMA">12. Lapangan SMA</option>
              <option value="Lapangan Depan Masjid">13. Lapangan Depan Masjid</option>
            </optgroup>
            <optgroup label="ğŸ“š Perpustakaan">
              <option value="Perpustakaan SD">14. Perpustakaan SD</option>
              <option value="Perpustakaan SMP">15. Perpustakaan SMP</option>
              <option value="Perpustakaan SMA">16. Perpustakaan SMA</option>
            </optgroup>
            <optgroup label="ğŸ•Œ Ruang Khusus">
              <option value="Masjid">17. Masjid</option>
              <option value="Kantin SMP">18. Kantin SMP</option>
              <option value="Kantin SMA">19. Kantin SMA</option
            </optgroup>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Tanggal *</label>
          <input type="date" class="form-input" id="bookingTanggal" required>
        </div>

        <div class="form-group">
          <label class="form-label">Waktu Mulai * (07.30-16.00)</label>
          <input type="time" class="form-input" id="bookingMulai" min="07:30" max="16:00" required>
        </div>

        <div class="form-group">
          <label class="form-label">Waktu Selesai * (07.30-16.00)</label>
          <input type="time" class="form-input" id="bookingSelesai" min="07:30" max="16:00" required>
        </div>

        <div class="form-group">
          <label class="form-label">Keterangan Kegiatan *</label>
          <textarea class="form-textarea" id="bookingKeterangan" placeholder="Contoh: Rapat OSIS, Pelajaran TIK, Seminar..." required></textarea>
        </div>

        <button type="submit" class="btn btn-primary">
          ğŸ“± Kirim ke WhatsApp + Cloud Sync
        </button>
      </form>
      
      <button class="btn btn-secondary" onclick="switchView('main')">
        â† Kembali ke Menu
      </button>
    </div>
  </template>

  <template id="partial-k3">
    <div class="header-gradient">
      <div class="arabic-large">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
      <h1 class="title-main">âš ï¸ Form K3</h1>
      <div class="subtitle">Laporan kerusakan + foto langsung ke Pak Erwin</div>
    </div>

    <div class="card">
      <form id="k3Form" onsubmit="event.preventDefault(); submitK3();">
        <div class="form-group">
          <label class="form-label">Jenis Laporan *</label>
          <select class="form-select" id="k3Jenis" required>
            <option value="">-- Pilih Jenis --</option>
            <option value="Kerusakan">Kerusakan (ke Maintenance)</option>
            <option value="Kehilangan">Kehilangan (ke Security)</option>
            <option value="Kebersihan">Kebersihan (ke Cleaning Service)</option>
            <option value="Emergency">Emergency (ke Maintenance)</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Lokasi Kejadian *</label>
          <input type="text" class="form-input" id="k3Lokasi" placeholder="Contoh: Lab Komputer 1" required>
        </div>

        <div class="form-group">
          <label class="form-label">Barang / Masalah *</label>
          <input type="text" class="form-input" id="k3Barang" placeholder="Contoh: AC rusak, kursi patah" required>
        </div>

        <div class="form-group">
          <label class="form-label">Deskripsi Detail *</label>
          <textarea class="form-textarea" id="k3Deskripsi" placeholder="Jelaskan secara detail kondisi, penyebab, dampak..." required></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Foto Dokumentasi (Opsional)</label>
          <input type="file" class="form-input" id="k3Foto" accept="image/*" capture="environment">
          <div style="color: #666; font-size: 0.85rem; margin-top: 6px;">
            ğŸ“¸ Ambil foto langsung dari kamera HP
          </div>
        </div>

        <button type="submit" class="btn btn-primary">
          ğŸ“¤ Kirim Laporan K3 ke Pak Erwin
        </button>
      </form>
      
      <button class="btn btn-secondary" onclick="switchView('main')">
        â† Kembali ke Menu
      </button>
    </div>
  </template>

  <script>
    // ========== CONFIG ==========
    const CONFIG = {
      VERSION: '4.3.3',
      WA_PAK_ERWIN: '628886183954',
      ADMIN_EMAIL: 'teknisi@alfikri.sch.id'
    };

    // ========== INITIALIZATION ==========
    document.addEventListener('DOMContentLoaded', function() {
      // Hide loading screen
      setTimeout(() => {
        document.getElementById('loading').style.opacity = '0';
        setTimeout(() => {
          document.getElementById('loading').style.display = 'none';
          document.getElementById('app').style.display = 'block';
          
          // Set current date in calendar
          const today = new Date();
          const dayElements = document.querySelectorAll('.calendar-day');
          dayElements[0].querySelector('div:last-child').textContent = today.getDate();
          
          for (let i = 1; i < 7; i++) {
            const nextDay = new Date(today);
            nextDay.setDate(today.getDate() + i);
            if (dayElements[i]) {
              const dayName = nextDay.toLocaleDateString('id-ID', { weekday: 'short' }).toUpperCase();
              dayElements[i].querySelector('div:first-child').textContent = dayName;
              dayElements[i].querySelector('div:last-child').textContent = nextDay.getDate();
            }
          }
        }, 500);
      }, 1500);

      // Set default date for booking form
      const today = new Date().toISOString().split('T')[0];
      if (document.getElementById('bookingTanggal')) {
        document.getElementById('bookingTanggal').value = today;
        document.getElementById('bookingTanggal').min = today;
      }
    });

    // ========== VIEW SYSTEM ==========
    function switchView(view) {
      // Hide all slots
      ['slot-booking', 'slot-k3', 'slot-admin', 'slot-sync'].forEach(id => {
        const slot = document.getElementById(id);
        if (slot) slot.style.display = 'none';
      });
      
      // Hide main menu
      document.querySelectorAll('.card[onclick^="switchView"]').forEach(card => {
        card.style.display = 'none';
      });
      
      // Handle main view
      if (view === 'main') {
        document.querySelectorAll('.card[onclick^="switchView"]').forEach(card => {
          card.style.display = 'block';
        });
        document.getElementById('loading').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        return;
      }
      
      // Load partial
      const template = document.getElementById(`partial-${view}`);
      const slot = document.getElementById(`slot-${view}`);
      
      if (template && slot) {
        slot.innerHTML = '';
        slot.appendChild(template.content.cloneNode(true));
        slot.style.display = 'block';
        
        // Initialize form for booking
        if (view === 'booking') {
          const today = new Date().toISOString().split('T')[0];
          const tanggalInput = document.getElementById('bookingTanggal');
          if (tanggalInput) {
            tanggalInput.value = today;
            tanggalInput.min = today;
            
            // Set default times
            const mulai = document.getElementById('bookingMulai');
            const selesai = document.getElementById('bookingSelesai');
            if (mulai) mulai.value = '08:00';
            if (selesai) selesai.value = '10:00';
          }
        }
      }
      
      window.scrollTo(0, 0);
    }

    // ========== BOOKING FUNCTIONS ==========
    function validateBooking() {
      const tanggal = document.getElementById('bookingTanggal').value;
      const sarana = document.getElementById('bookingSarana').value;
      const mulai = document.getElementById('bookingMulai').value;
      const selesai = document.getElementById('bookingSelesai').value;
      
      const date = new Date(tanggal);
      const day = date.getDay(); // 0 = Sunday, 5 = Friday
      
      // Friday validation
      if (day === 5) {
        if (sarana.includes("Aula SMP") || sarana.includes("Serbaguna")) {
          return {
            valid: false,
            message: "âŒ Aula SMP & Serbaguna tidak tersedia Jum'at (Persiapan Shalat Jum'at)"
          };
        }
        
        if (mulai < "10:30" || selesai > "13:00") {
          return {
            valid: false,
            message: "â° Jum'at: booking hanya diperbolehkan pukul 10.30 - 13.00 WIB"
          };
        }
      }
      
      // Regular hours validation (Monday-Thursday)
      if (mulai < "07:30" || selesai > "16:00") {
        return {
          valid: false,
          message: "â° Waktu booking hanya 07.30 - 16.00 WIB (Senin-Kamis)"
        };
      }
      
      // Check if end time is after start time
      if (mulai >= selesai) {
        return {
          valid: false,
          message: "âŒ Waktu selesai harus setelah waktu mulai"
        };
      }
      
      return { valid: true };
    }

    function submitBooking() {
      // Validate WA number
      const waInput = document.getElementById('bookingWA').value;
      const waNumber = waInput.replace(/[^0-9]/g, '');
      if (waNumber.length < 10 || waNumber.length > 13) {
        alert('âŒ Nomor WhatsApp tidak valid! Contoh: 08123456789');
        return;
      }
      
      // Validate booking time
      const validation = validateBooking();
      if (!validation.valid) {
        alert(validation.message);
        return;
      }
      
      // Collect data
      const bookingData = {
        nama: document.getElementById('bookingNama').value.trim(),
        divisi: document.getElementById('bookingDivisi').value,
        whatsapp: waNumber,
        sarana: document.getElementById('bookingSarana').value,
        tanggal: document.getElementById('bookingTanggal').value,
        waktu_mulai: document.getElementById('bookingMulai').value,
        waktu_selesai: document.getElementById('bookingSelesai').value,
        keterangan: document.getElementById('bookingKeterangan').value.trim(),
        created_at: new Date().toISOString(),
        status: 'pending'
      };
      
      // Format WhatsApp message
      const waMessage = `
ğŸ“… *BOOKING FASILITAS - SIF AL FIKRI*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ‘¤ Nama: ${bookingData.nama}
ğŸ¢ Divisi: ${bookingData.divisi}
ğŸ“ WA: ${bookingData.whatsapp}
ğŸ›ï¸ Sarana: ${bookingData.sarana}
ğŸ“… Tanggal: ${new Date(bookingData.tanggal).toLocaleDateString('id-ID')}
â° Waktu: ${bookingData.waktu_mulai} - ${bookingData.waktu_selesai}
ğŸ“ Kegiatan: ${bookingData.keterangan}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ¿ Dream OS v${CONFIG.VERSION}
ğŸ“± Otomatis dari sistem
      `.trim();
      
      // Open WhatsApp
      const waUrl = `https://wa.me/${CONFIG.WA_PAK_ERWIN}?text=${encodeURIComponent(waMessage)}`;
      window.open(waUrl, '_blank');
      
      // Save to localStorage
      const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
      bookings.push(bookingData);
      localStorage.setItem('dream_bookings', JSON.stringify(bookings));
      
      // Show success message
      setTimeout(() => {
        alert('âœ… Booking berhasil dikirim!\n\nğŸ“± Pesan sudah terkirim ke WhatsApp Pak Erwin\nğŸ’¾ Data tersimpan lokal di browser\n\nTerima kasih!');
        switchView('main');
      }, 1000);
    }

    // ========== K3 FUNCTIONS ==========
    function submitK3() {
      const k3Data = {
        jenis: document.getElementById('k3Jenis').value,
        lokasi: document.getElementById('k3Lokasi').value.trim(),
        barang: document.getElementById('k3Barang').value.trim(),
        deskripsi: document.getElementById('k3Deskripsi').value.trim(),
        created_at: new Date().toISOString(),
        status: 'pending'
      };
      
      // Get routing info
      const teamName = k3Data.jenis === 'Kehilangan' ? 'Security' :
                      k3Data.jenis === 'Kebersihan' ? 'Cleaning Service' :
                      k3Data.jenis === 'Emergency' ? 'Maintenance (Emergency)' : 'Maintenance';
      
      // Format WhatsApp message
      const waMessage = `
âš ï¸ *LAPORAN K3 - ${teamName.toUpperCase()}*
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“‹ Jenis: ${k3Data.jenis}
ğŸ“ Lokasi: ${k3Data.lokasi}
ğŸ› ï¸ Barang/Masalah: ${k3Data.barang}
ğŸ“ Deskripsi: ${k3Data.deskripsi}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸš¨ Priority: ${k3Data.jenis === 'Emergency' ? 'TINGGI' : 'NORMAL'}
ğŸ“± Device: ${navigator.userAgent.split(') ')[0].split('(')[1] || 'Unknown'}
ğŸŒ¿ Dream OS v${CONFIG.VERSION}
      `.trim();
      
      // Open WhatsApp
      const waUrl = `https://wa.me/${CONFIG.WA_PAK_ERWIN}?text=${encodeURIComponent(waMessage)}`;
      window.open(waUrl, '_blank');
      
      // Save to localStorage
      const k3Reports = JSON.parse(localStorage.getItem('dream_k3_reports') || '[]');
      k3Reports.push(k3Data);
      localStorage.setItem('dream_k3_reports', JSON.stringify(k3Reports));
      
      // Show success message
      setTimeout(() => {
        alert(`âœ… Laporan K3 berhasil dikirim!\n\nğŸ“± Terkirim ke Pak Erwin (${teamName})\nğŸ’¾ Data tersimpan lokal\n\nTerima kasih atas laporannya!`);
        switchView('main');
      }, 1000);
    }

    // ========== UTILITY FUNCTIONS ==========
    function showCalendarDetails() {
      const today = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      const dateStr = today.toLocaleDateString('id-ID', options);
      
      const bookings = JSON.parse(localStorage.getItem('dream_bookings') || '[]');
      const todayBookings = bookings.filter(b => b.tanggal === today.toISOString().split('T')[0]);
      
      let message = `ğŸ“… Kalender Dream OS\n\n`;
      message += `Hari ini: ${dateStr}\n`;
      message += `Total booking hari ini: ${todayBookings.length}\n\n`;
      
      if (todayBookings.length > 0) {
        message += `Booking Hari Ini:\n`;
        todayBookings.forEach((b, i) => {
          message += `${i+1}. ${b.sarana.split(' - ')[0]}\n   ğŸ‘¤ ${b.nama} (${b.divisi})\n   â° ${b.waktu_mulai}-${b.waktu_selesai}\n\n`;
        });
      } else {
        message += `Tidak ada booking untuk hari ini.\n`;
      }
      
      alert(message);
    }

    // ========== ONLINE/OFFLINE DETECTION ==========
    window.addEventListener('online', () => {
      const badge = document.querySelector('.badge.online');
      if (badge) {
        badge.textContent = 'ğŸŸ¢ ONLINE';
        badge.style.color = '#4CAF50';
      }
    });

    window.addEventListener('offline', () => {
      const badge = document.querySelector('.badge.online');
      if (badge) {
        badge.textContent = 'ğŸ”´ OFFLINE';
        badge.style.color = '#D32F2F';
      }
      alert('âš ï¸ Sedang offline - data akan disimpan lokal');
    });
  </script>
</body>
</html>
